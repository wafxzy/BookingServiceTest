<div class="container mx-auto px-4 py-8">
  <div class="mb-8">
    <h1 class="text-4xl font-bold text-gray-900 mb-4">–ü–æ–∏—Å–∫ –æ—Ç–µ–ª–µ–π</h1>
    
    <div class="bg-white p-6 rounded-lg shadow-md">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">–ì–æ—Ä–æ–¥</label>
          <input
            type="text"
            [(ngModel)]="searchCity"
            (keyup.enter)="searchHotels()"
            placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥..."
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">–î–∞—Ç–∞ –∑–∞–µ–∑–¥–∞</label>
          <input
            type="date"
            [(ngModel)]="searchCheckIn"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">–î–∞—Ç–∞ –≤—ã–µ–∑–¥–∞</label>
          <input
            type="date"
            [(ngModel)]="searchCheckOut"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
        </div>
        
        <div class="flex flex-col justify-end">
          <div class="flex gap-2">
            <button
              (click)="searchHotels()"
              class="flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium"
            >
              –ü–æ–∏—Å–∫
            </button>
            @if (searchCity || searchCheckIn || searchCheckOut) {
              <button
                (click)="clearSearch()"
                class="px-4 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition"
                title="–°–±—Ä–æ—Å–∏—Ç—å"
              >
                ‚úï
              </button>
            }
          </div>
        </div>
      </div>
    </div>
  </div>

  @if (isLoading) {
    <div class="text-center py-12">
      <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
      <p class="mt-4 text-gray-600">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
    </div>
  }

  @if (errorMessage) {
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
      {{ errorMessage }}
    </div>
  }

  <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–∏—Å–∫–µ -->
  @if (searchCity || searchCheckIn || searchCheckOut) {
    <div class="mb-6">
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-4">
            <div class="flex items-center gap-2">
              @if (searchCity) {
                <span class="text-blue-800 font-medium">–ì–æ—Ä–æ–¥: {{ searchCity }}</span>
              }
              @if (searchCheckIn) {
                <span class="text-blue-600">–ó–∞–µ–∑–¥: {{ searchCheckIn }}</span>
              }
              @if (searchCheckOut) {
                <span class="text-blue-600">–í—ã–µ–∑–¥: {{ searchCheckOut }}</span>
              }
            </div>
            <span class="bg-blue-600 text-white px-2 py-1 rounded-full text-sm">
              {{ filteredHotels.length }}
            </span>
          </div>
          <button
            (click)="clearSearch()"
            class="text-blue-600 hover:text-blue-800 font-medium text-sm"
          >
            ‚úï –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫
          </button>
        </div>
      </div>
    </div>
  }

  @if (!isLoading && filteredHotels.length === 0) {
    <div class="text-center py-12 bg-white rounded-lg shadow">
      <p class="text-xl text-gray-600">–û—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
      @if (searchCity || searchCheckIn || searchCheckOut) {
        <p class="text-gray-500 mt-2">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞</p>
      }
    </div>
  }

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    @for (hotel of filteredHotels; track hotel.id) {
      <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition">
        <div class="bg-gradient-to-r from-blue-500 to-blue-600 h-48 flex items-center justify-center">
          <span class="text-6xl">üè®</span>
        </div>
        
        <div class="p-6">
          <h3 class="text-2xl font-bold text-gray-900 mb-2">{{ hotel.name }}</h3>
          <p class="text-gray-600 mb-1">
            <span class="font-semibold">üìç</span> {{ hotel.city }}
          </p>
          <p class="text-gray-600 mb-4">{{ hotel.address }}</p>
          <p class="text-gray-700 mb-4">{{ hotel.description }}</p>
          
          @if (hotel.rooms && hotel.rooms.length > 0) {
            <div class="border-t pt-4 mt-4">
              <h4 class="font-semibold text-lg mb-3">–î–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–æ–º–µ—Ä–∞:</h4>
              <div class="space-y-3">
                @for (room of hotel.rooms; track room.id) {
                  <div class="border rounded-lg p-4 hover:bg-gray-50 transition">
                    <div class="flex justify-between items-start mb-2">
                      <div>
                        <p class="font-semibold text-gray-900">{{ room.type }} - ‚Ññ{{ room.roomNumber }}</p>
                        <p class="text-sm text-gray-600">–î–æ {{ room.maxOccupancy }} –≥–æ—Å—Ç–µ–π</p>
                      </div>
                      <div class="text-right">
                        <p class="text-2xl font-bold text-blue-600">{{ room.pricePerNight }} ‚Ç¥</p>
                        <p class="text-sm text-gray-500">–∑–∞ –Ω–æ—á—å</p>
                      </div>
                    </div>
                    <p class="text-sm text-gray-600 mb-3">{{ room.description }}</p>
                    @if (room.isAvailable) {
                      <button
                        (click)="openBookingModal(room)"
                        class="w-full bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 transition font-medium"
                      >
                        –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å
                      </button>
                    } @else {
                      <button
                        disabled
                        class="w-full bg-gray-300 text-gray-600 py-2 px-4 rounded-lg cursor-not-allowed"
                      >
                        –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ
                      </button>
                    }
                  </div>
                }
              </div>
            </div>
          } @else {
            <p class="text-gray-500 italic">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤</p>
          }
        </div>
      </div>
    }
  </div>
</div>

<!-- Booking Modal -->
@if (showBookingModal && selectedRoom) {
  <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
    <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6">
      <h3 class="text-2xl font-bold mb-4">–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞</h3>
      
      <div class="mb-4 p-4 bg-gray-50 rounded">
        <p class="font-semibold">{{ selectedRoom.type }} - ‚Ññ{{ selectedRoom.roomNumber }}</p>
        <p class="text-2xl font-bold text-blue-600 mt-2">{{ selectedRoom.pricePerNight }} ‚Ç¥ / –Ω–æ—á—å</p>
      </div>

      <form (ngSubmit)="bookRoom()" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            –î–∞—Ç–∞ –∑–∞–µ–∑–¥–∞
          </label>
          <input
            type="date"
            [(ngModel)]="bookingData.checkInDate"
            name="checkInDate"
            required
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            –î–∞—Ç–∞ –≤—ã–µ–∑–¥–∞
          </label>
          <input
            type="date"
            [(ngModel)]="bookingData.checkOutDate"
            name="checkOutDate"
            required
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
        </div>

        <div class="flex gap-3 pt-4">
          <button
            type="button"
            (click)="closeBookingModal()"
            class="flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition"
          >
            –û—Ç–º–µ–Ω–∞
          </button>
          <button
            type="submit"
            class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium"
          >
            –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
          </button>
        </div>
      </form>
    </div>
  </div>
}
